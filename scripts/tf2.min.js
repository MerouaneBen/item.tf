(function(){var t,u,v,x,n,y,w,z,k,s,A,B,l=[].indexOf||function(b){for(var a=0,c=this.length;a<c;a++)if(a in this&&this[a]===b)return a;return-1},p=function(b,a){return function(){return b.apply(a,arguments)}};s="undefined"!==typeof exports&&null!==exports?exports:this;k=["backpack.tf","spreadsheet"];x=function(){function b(){this.id=w("steam_id");this.loggedIn=Boolean(this.id);Object.defineProperties(this,{priceSource:{get:function(){return w("price_source")||k[0]},set:function(a){return A("price_source",
a,365)}}})}b.prototype.isOwnPage=function(){var a;return this.loggedIn&&this.id===(null!=(a=document.getElementById("steamid"))?a.getAttribute("data-id"):void 0)};return b}();u=function(){function b(a){var c,d,b,e,f;this.elem=a;this.name=a.title;this.id=a.getAttribute("data-index");this.imageUrl=a.getAttribute("data-image");this.description=a.getAttribute("data-description")||"";this.level=a.getAttribute("data-level");this.attributes=(null!=(c=a.getElementsByTagName("div"))?null!=(d=c[0])?d.innerHTML:
void 0:void 0)||"";this.classes=(a.getAttribute("data-classes")||"").split(",");this.tags=(a.getAttribute("data-tags")||"").split(",");this.storePrice=a.getAttribute("data-storeprice");this.blueprints=a.getElementsByTagName("ul");this.prices={};b=0;for(e=k.length;b<e;b++)d=k[b],(c=JSON.parse(this.elem.getAttribute("data-"+d)))&&(this.prices[d]=c);this.wishIndex=a.getAttribute("data-i");this.qualityNo=null!=(f=a.className.match(/quality-(\d+)/))?f[1]:void 0}b.prototype.remove=function(){return this.elem.parentNode.removeChild(this.elem)};
return b}();v=function(){function b(a){this.showLink=null!=a?a:!0;this.elem=document.createElement("div");this.elem.id="itembox";document.getElementsByTagName("body")[0].appendChild(this.elem)}b.prototype.show=function(a){this.item=new u(a);this.source=user.priceSource;this._generate();return this.elem.style.display="block"};b.prototype.hide=function(){return this.elem.style.display="none"};b.prototype._nextPriceSource=function(){return this.source=k[(k.indexOf(this.source)+1)%k.length]};b.prototype._tagsHTML=
function(){var a,c,d,b,e,f,h,m,q;if(this.item.tags.length){a='<div id="tags">';e=0<=l.call(this.item.tags,"weapon");b=0<=l.call(this.item.tags,"token");q=["primary","secondary","melee","pda2"];h=0;for(m=q.length;h<m;h++)c=q[h],0<=l.call(this.item.tags,c)&&(e?(c=[""+n(c)+" Weapon",c],f=c[0],d=c[1]):b&&(c=["Slot Token","slot-token"],f=c[0],d=c[1]));m=["hat","misc","tool","bundle"];e=0;for(h=m.length;e<h;e++)c=m[e],0<=l.call(this.item.tags,c)&&(c=[n(c),c],f=c[0],d=c[1]);b&&this.item.classes.length&&
(b=["Class Token","class-token"],f=b[0],d=b[1]);null!=f&&null!=d&&(a+='<a href="/search?q='+encodeURIComponent(f)+'"\n target="_blank" title="'+f+'" class="'+d+'"></a>');return a+"</div>"}return""};b.prototype._nameHTML=function(){var a;a=this.item.name;this.showLink&&(a='<a href="/item/'+this.item.id+'"\n target="_blank" class="glow" title="Go to Item Page">'+a+"</a>");return"<h2 id='itemname'>"+a+"</h2>"};b.prototype._classesHTML=function(){var a,c,d,b,e;if(this.item.classes.length){a='<div id="classes">';
e=this.item.classes;d=0;for(b=e.length;d<b;d++)c=e[d],a+='<a href="/search?q='+c+'" target="_blank"\n title="'+c+'" class="'+c.toLowerCase()+'"></a>';return a+"</div>"}return""};b.prototype._bundleHTML=function(){return 0<=l.call(this.item.tags,"bundle")&&-1!==this.item.description.indexOf("---")?'<a href="/search?q='+encodeURIComponent(this.item.name)+'%20Set"\n target="_blank">\n<div class="rounded glow" style="display: inline-block; padding: 7px">\nView Items\n</div>\n</a>':""};b.prototype._priceSourceHTML=
function(){var a,c,d,b,e;c="";this.item.prices[this.source]||this._nextPriceSource();if(this.item.prices[this.source])for(b in e=this.item.prices[this.source],e){d=e[b];if(a=d.match(/(Refined|Key(s)?|Bud(s)?)/))a=a[0],d=d.replace(/(\d+(\.\d+)?)/g,'<a href="/search?q=$1%20'+a+'"\n target="_blank" class="glow">$1</a>');c+="<span class='"+b.toLowerCase()+"'>"+b+"</span>: "+d+"<br>"}return c};b.prototype._pricesHTML=function(){var a;return(a=this._priceSourceHTML())?"<div id='marketprice'><span id='pricesource'>"+
n(this.source)+"</span><h3 id='prices'>"+a+"</h3></div>":""};b.prototype._blueprintsHTML=function(){var a,c,b,g,e,f,h,m,q,k,l,n,p,r;if(this.item.blueprints.length){b='<div id="blueprints">';n=this.item.blueprints;h=0;for(k=n.length;h<k;h++){a=n[h];c=a.getAttribute("data-chance");b+='<div class="blueprint">';p=a.getElementsByTagName("li");m=0;for(l=p.length;m<l;m++){a=p[m];q=0;for(r=a.getAttribute("data-count");0<=r?q<r:q>r;0<=r?++q:--q)f=a.title,g=a.getAttribute("data-index"),e="background-image: url("+
a.getAttribute("data-image")+")",e='<div title="'+f+"\" class='item-small' style='"+e+"'></div>",g?g="/item/"+g:(f=f.replace("Any ","").replace("Spy Watch","PDA2 Weapon"),2<f.split(" ").length&&(f=f.replace("Weapon","Set")),g="/search?q="+encodeURIComponent(f)),b+='<a href="'+g+"\" target='_blank'>"+e+"</a>"}b+='<div title="Crafting Chance" style="position: absolute; right: 10px">\n<h3>'+c+"%</h3></div></div>"}return b+"</div>"}return""};b.prototype._outpostHTML=function(){return'<a href="#" id="find-trades-btn"\n class="icon-exchange icon-large button-icon" title="Find Trades"></a>\n\n<form name="tf2outpostform" method="POST" style="display: inline-block"\n action="http://www.tf2outpost.com/search">\n\n<input type="hidden" name="json">\n<input type="hidden" name="type" value="any">\n<input type="submit" name="submit" value="Search" style="display: none">\n\n<select id="tradetype" class="textbox">\n  <option value="has1">Want</option>\n  <option value="wants1">Have</option>\n</select>\n\n<select id="quality" class="textbox">\n  <option value="6">Unique</option>\n  <option value="3">Vintage</option>\n  <option value="11">Strange</option>\n  <option value="1">Genuine</option>\n  <option value="13">Haunted</option>\n  <option value="5">Unusual</option>\n</select>\n\n</form>'};
b.prototype._wishlistHTML=function(){return user.loggedIn?'<div style="display: inline-block; width: 40px">\n<div id="wishlistmessage"\n style="display: none; margin: 0 0 4px -18px">Added</div>\n<i id="wishlistbutton" class="button-icon rounded icon-star icon-large"\n style="background-color: transparent"\n title="Add to Wishlist"></i>\n</div>':""};b.prototype._buttonsHTML=function(){return'<div id="buttons">\n\n<a class="icon-info icon-large button-icon" target="_blank"\n title="Open in Wiki" href="http://wiki.teamfortress.com/wiki/'+
encodeURIComponent(this.item.name)+'"></a>\n\n<a class="icon-shopping-cart icon-large button-icon"\n target="_blank" title="Community Market"\n href="http://steamcommunity.com/market/search?q=appid%3A440%20'+encodeURIComponent(this.item.name)+'"></a>\n\n<a class="icon-list icon-large button-icon" target="_blank"\n title="Backpack.tf Classifieds"\n href="http://backpack.tf/ajax/search_generate.php?defindex='+this.item.id+'&appid=440&redir=classifieds"></a>\n\n'+this._outpostHTML()+"\n"+this._wishlistHTML()+
"\n</div>"};b.prototype._buyHTML=function(){return this.item.storePrice?'<div id="buy">\n<form style="display: inline-block">$'+this.item.storePrice+'<br>\n<input type="text" value="1" size="1" id="quantity"\n class="textbox" style="text-align: right">\n</form><a href="#" target="_blank" id="buybutton"></a></div>':""};b.prototype._pricesLink=function(){var a,c,b=this;a=document.getElementById("pricesource");c=document.getElementById("prices");if(a&&1<Object.keys(this.item.prices).length)return a.style.cursor=
"pointer",a.onclick=function(){b._nextPriceSource();a.innerHTML=n(b.source);return c.innerHTML=b._priceSourceHTML()},a.onmouseover=function(){return a.style.textShadow="0 0 10px rgb(196, 241, 128)"},a.onmouseout=function(){return a.style.textShadow=""}};b.prototype._outpostLink=function(){var a=this;-1===window.navigator.userAgent.indexOf("Valve Steam GameOverlay")&&(this.form.target="_blank");return document.getElementById("find-trades-btn").onclick=function(c){c=document.getElementById("tradetype").value;
a.form.json.value='{"filters":{},"'+c+'":"440,'+a.item.id+","+a.form.quality.value+'"}';return a.form.submit.click()}};b.prototype._wishlistLink=function(){var a,c,b,g,e,f,h=this;if(user.isOwnPage()){f=document.getElementsByClassName("item");c=g=0;for(e=f.length;g<e;c=++g)if(b=f[c],b.getAttribute("data-i")===this.item.wishIndex){this.item.wishIndex=c.toString();break}}if(user.loggedIn)return a="/wishlist/add",c=document.getElementById("wishlistbutton"),user.isOwnPage()&&(a="/wishlist/remove",c.title=
"Remove from Wishlist"),c.onclick=function(){var c;c={index:h.item.id,quality:h.form.quality.value};user.isOwnPage()&&(c={i:h.item.wishIndex});return z(a,c,function(a){var c;if("Added"===a)return c=document.getElementById("wishlistmessage"),c.style.display="block",c.className="animated fadeInLeft",setTimeout(function(){return c.className="animated fadeOut"},1E3);if("Removed"===a)return h.hide(),h.item.remove()})}};b.prototype._buyLink=function(){var a,c,b=this;if(a=document.getElementById("buybutton"))return c=
document.getElementById("quantity"),(c.onchange=function(){return a.href="http://store.steampowered.com/buyitem/440/"+b.item.id+"/"+c.value})()};b.prototype._generate=function(){var a,c,b,g,e,f;this.elem.innerHTML=""+this._tagsHTML()+this._nameHTML()+this._classesHTML()+"\n"+this._bundleHTML()+"\n"+this._pricesHTML()+"\n"+this._blueprintsHTML()+"\n"+this._buttonsHTML()+this._buyHTML();this.form=document.tf2outpostform;this._pricesLink();this._outpostLink();this._wishlistLink();this._buyLink();a=this.item.elem.cloneNode(!0);
a.id="hoverarea";a.className="";a.setAttribute("style","background-image: url("+this.item.imageUrl+")");this.elem.insertBefore(a,document.getElementById("blueprints")||document.getElementById("buttons"));new t(a);if(this.item.qualityNo)return this.form.quality.value=this.item.qualityNo;if(this.item.prices[this.source]){e=this.form.quality.options;f=[];a=b=0;for(g=e.length;b<g;a=++b)if(c=e[a],c.innerHTML in this.item.prices[this.source]){this.form.quality.selectedIndex=a;break}else f.push(void 0);
return f}};return b}();t=function(){function b(a,c){this.itemBox=c;this._clickItem=p(this._clickItem,this);this._moveMouse=p(this._moveMouse,this);this._hideItemBox=p(this._hideItemBox,this);this._hide=p(this._hide,this);this._show=p(this._show,this);a instanceof v&&(this.itemBox=a,a=null);this.elem=document.getElementById("hoverbox");this.elem||(this.elem=document.createElement("div"),this.elem.id="hoverbox",document.getElementsByTagName("body")[0].appendChild(this.elem));this._add(a)}b.prototype._add=
function(a){var c,b,g,e=this;c=a?[a]:document.getElementsByClassName("item");b=0;for(g=c.length;b<g;b++)a=c[b],a.addEventListener("mouseout",this._hide,!1),a.addEventListener("mousemove",this._moveMouse,!1),a.addEventListener("mouseover",this._show,!1),this.itemBox&&a.addEventListener("click",this._clickItem,!1);if(this.itemBox)return document.getElementsByTagName("body")[0].addEventListener("click",this._hideItemBox,!1),document.onkeydown=function(a){if(27===a.keyCode)return e.itemBox.hide()}};b.prototype._show=
function(a){var c;a=new u(a.target);if(c=y(a.description))0<=l.call(a.tags,"bundle")&&-1!==c.indexOf("---")&&(c=c.split("---"),c=""+c[0]+'\n<span style="color: #95af0c">'+c[1]+"</span>"),c="<br>"+c;this.elem.innerHTML='<div style="font-size: 1.2em; color: rgb(230, 230, 230)">'+a.name+'</div><span style="color: gray">'+a.level+"</span>"+a.attributes+c;return this.elem.style.display="block"};b.prototype._hide=function(){return this.elem.style.display="none"};b.prototype._hideItemBox=function(a){var c,
b;a=a.target;if("item"!==a.className){for(c=[];a;)c.push(a),a=a.parentNode;if(b=this.itemBox.elem,0>l.call(c,b))return this.itemBox.hide()}};b.prototype._moveMouse=function(a){this.elem.style.top=""+(a.pageY+28)+"px";return this.elem.style.left=""+(a.pageX-154)+"px"};b.prototype._clickItem=function(a){this.itemBox.show(a.target);a.preventDefault();return a.stopPropagation()};return b}();n=function(b){return b[0].toUpperCase()+b.slice(1)};y=function(b){return b.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,
"&gt;")};w=function(b){var a,c,d,g;c=document.cookie.split(";");d=0;for(g=c.length;d<g;d++){for(a=c[d];" "===a[0];)a=a.slice(1);if(a.slice(0,b.length)===b)return a.slice(b.length+1)}};A=function(b,a,c){var d;d="";c&&(d=new Date,d.setDate(d.getDate()+c),d=";expires="+d.toUTCString());return document.cookie=""+b+"="+a+d};z=function(b,a,c){var d,g;c=B(c);c.open("POST",b,!0);c.setRequestHeader("Content-Type","application/x-www-form-urlencoded");return c.send(function(){var b;b=[];for(d in a)g=a[d],b.push(""+
d+"="+g);return b}().join("&"))};B=function(b){var a;a=new XMLHttpRequest;a.onreadystatechange=function(){if(4===a.readyState&&200===a.status)return b(a.responseText)};return a};s.user=new x;s.ItemBox=v;s.HoverBox=t}).call(this);
