<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>TF2 Find</title>
    <meta name="description" content="Find TF2 items and quickly get information about crafting blueprints, market prices and more." />
    <meta name="google-site-verification" content="tQE3vSNvF6gI8yGNH4RHNIWKZc8nNGvRdn4adkWf1CQ" />
    {% set searchurl = homepage+'/searchdescription.xml' -%}
    <link rel="search" type="application/opensearchdescription+xml" title="TF2 Find" href="{{searchurl}}">
    <link rel="stylesheet" href="/css/tf2.css">
    <link rel="stylesheet" href="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.21/themes/ui-lightness/jquery-ui.css">
    <script src="/scripts/tf2.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.18/jquery-ui.min.js"></script>
    <style>
      .ui-autocomplete {
        max-height: 100px;
        overflow-y: auto;
        /* prevent horizontal scrollbar */
        overflow-x: hidden;
        /* add padding to account for vertical scrollbar */
        padding-right: 20px;
      }
      .ui-widget-content {
        background: #292927;
        border: none;
      }
      .ui-widget-content a {
        color: rgb(150,150,150);
      }
      .ui-widget-content .ui-state-hover{
        color: white;
        background: #1E1D1C;
        border: none;
      }
    </style>
    <style>.itemlist{width:540px;margin-top:50px;}</style>
    {% include 'analytics.html' %}
  </head>
{% from 'macros.html' import showitems, showsearchlinks, getcount %}
  <body>
    <div id="container">
      <header style="height: 10px"></header>
      <div id="sidebar" class="rounded">
        <h3 id="hover">Help</h3>
        <div id="list">
        <h4>Examples</h4>
        <p>
        {{ showsearchlinks(['engi hats','medic weps','demo melee','sniper spy','the saharan spy set']) }}
        </p>
        <h4>Keywords</h4>
        <p>
        {{ showsearchlinks(['all','sets','random']) }}
        <br>
        {{ showsearchlinks(tags) }}
        </p>
        </div>
      </div>
      <div id="hoverbox"></div>
      <div id="itembox"></div>

      <div id="body">
      <h1 style="margin-top:120px; background-color: rgba(255, 255, 255, 0.02); display: inline-block;">TF2 Find</h1>
      <h4 id="addsearch" style="position:absolute;top:10px;left:10px;display:none"><a href="#" class="rounded" onclick="window.external.AddSearchProvider('{{searchurl}}')">Add Search Engine</a></h4>
      <form action="/search">
        <input name="q" id="searchbox" type="search" placeholder="Search" size="41" style="margin-top: 30px; font-size:1.4em;"><br><br>
        <input type="submit" value="Search" class="button">
        <input type="button" value="Lucky?" class="button" onclick="window.parent.location.href='/search?q=random'">
      </form>
      {{ showitems(newitems, False) }}
      {% include 'message.html' %}
      </div>
      <footer>Last Updated - {{getcount(lastupdated,'minute')}} ago<br>{% include 'footer.html' %}</footer>
    </div>
  <script>
    $('#searchbox').focus();
    $('#hover').hover(function() {$('#list').show('slow')});
    addHoverBox();
    $(function() {
      var accentMap = {
          'ä': 'a',
          'é': 'e',
          'ò': 'o'
      };

      var normalize = function( term ) {
          var ret = "";
          for ( var i = 0; i < term.length; i++ ) {
              ret += accentMap[ term.charAt(i) ] || term.charAt(i);
          }
          return ret;
      };

      $.getJSON('/suggest', function (data) {

        $( "#searchbox" ).autocomplete({
          source: function( request, response ) {
              var matcher = new RegExp( $.ui.autocomplete.escapeRegex( request.term ), "i" );
              response( $.grep( data[1], function( value ) {
                  value = value.label || value.value || value;
                  return matcher.test( value ) || matcher.test( normalize( value ) );
              }) );
          },
          autoFocus: true, delay: 50, minLength: 2
        });
      });
    });
    if (!window.external.IsSearchProviderInstalled("{{homepage}}")) {$('#addsearch').show()}
  </script>
  </body>
</html>
